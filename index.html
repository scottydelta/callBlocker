<html>
<head>
 <link rel="stylesheet" type="text/css" href="css/input_areas.css">
  <link rel="stylesheet" type="text/css" href="css/headers.css">
  <link rel="stylesheet" type="text/css" href="css/buttons.css">
  <link rel="stylesheet" type="text/css" href="css/lists.css">
<script>
//localStorage.clear();
var telephone = navigator.mozTelephony;
telephony.onincoming = function onincoming(event){
	var incomingCall = event.call;
	if(localStorage(incomingCall.number)!==null)
		incomingCall.hangUp();
		};

function blockNumber(){
		anumber = document.getElementById("anumber").value;
		if (anumber !== "" && localStorage.getItem(anumber)==null){
			localStorage.setItem(anumber, "blocked");
			alert(anumber + " added to Block List");
			}
		else if(anumber==="")
			var man;
		else
			alert(anumber + " already in Block List");
        };

function unblockNumber(){
		anumber = document.getElementById("anumber").value;
		if (localStorage.getItem(anumber)===null && anumber!==""){
			var r=confirm(anumber + " not in Block List, To block it, Press OK");
			if (r==true){
				localStorage.setItem(anumber, "blocked");
			}
			}
		else if(anumber==="")
			var man;
		else{
			localStorage.removeItem(anumber);
			alert(anumber + " removed from Block List");	
			}
		};

function printNumber(){
		var listLength = localStorage.length;
		var pb = document.getElementById("pageBody");
		pb.innerHTML="";
		var templist="";
		for (var i=0; i<listLength; i++){
			var rnumber = localStorage.key(i)
			console.log(rnumber);
			templist+='<li onClick="removeNumber('  + rnumber + ')"><p>'+ localStorage.key(i) + "</p><p>click to remove</p></li>";
			}
		if(templist==="")
				templist="No Number to be Blocked";
			pb.innerHTML='<section class="skin-organic" role="region"><header><a href="#"><span class="icon icon-back" onClick="mainPage()">back</span></a><h1>Call Blocker</h1></header><br><section data-type="list"><ul>' + templist+'</ul></section><br><button onclick="mainPage()">Back</button>';
		};	
function removeNumber(rnumber){
		localStorage.removeItem(rnumber);
		var pb = document.getElementById("pageBody");
		var listLength = localStorage.length;
		pb.innerHTML="";
		var templist="";
		for (var i=0; i<listLength; i++){
			var rnumber = localStorage.key(i)
			templist+='<li onClick="removeNumber('  + rnumber + ')"><p>'+ localStorage.key(i) + "</p><p>click to remove</p></li>";
			}
		if(templist==="")
				templist="No Number to be Blocked";
			pb.innerHTML='<section class="skin-organic" role="region"><header><a href="#"><span class="icon icon-back" onClick="mainPage()()">back</span></a><h1>Call Blocker</h1></header><br><section data-type="list"><ul>' + templist+'</ul></section><br><button onclick="mainPage()">Back</button>';
		};
			
function mainPage(){
			document.getElementById("pageBody").innerHTML = '<section class="skin-organic" role="region"><header><h1>Call Blocker</h1></header><br><input type="text" id= "anumber" placeholder="Phone Number"><br><button onclick="blockNumber()">Block</button><br><button onclick="unblockNumber()">Unblock</button><br><button onclick="printNumber()">Block List</button><br>';
			};

</script>
</head>
<body>
<div id="pageBody" style="" >

<section class="skin-organic" role="region">
  <header>
    
    <h1>Call Blocker</h1>
</header>
<br>
<input type="text" id= "anumber" placeholder="Phone Number"><br>
<button onclick="blockNumber()">Block</button><br>
<button onclick="unblockNumber()">Unblock</button><br>
<button onclick="printNumber()">Block List</button><br>
</section>
</div>
</body>
</html>
